let db;

self.addEventListener("unhandledrejection", (event) => {
    const reason = event?.reason
    console.error(reason)
    let error = reason?.stack || reason?.message
    if (typeof error !== "string" || !error) {
        error = "Something went wrong"
    }
    self.postMessage({ error })
});

self.onmessage = async ({ data }) => {
    if (!db) await IDBinit()

    const collectionToPut = {}
    let tagInfo = await retrieveJSON("tagInfo")
    if (!isJsonObject(tagInfo) || jsonIsEmpty(tagInfo)) {
        self.postMessage({ status: "Getting Filters" })
        tagInfo = {
            Technical: {
                "4-koma": "A manga in the 'yonkoma' format, which consists of four equal-sized panels arranged in a vertical strip.",
                "Achromatic": "Contains animation that is primarily done in black and white.",
                "Advertisement": "Produced in order to promote the products of a certain company.",
                "Anthology": "A collection of separate works collated into a single release.",
                "CGI": "Prominently features scenes created with computer-generated imagery.",
                "Episodic": "Features story arcs that are loosely tied or lack an overarching plot.",
                "Flash": "Created using Flash animation techniques.",
                "Full CGI": "Almost entirely created with computer-generated imagery.",
                "Full Color": "Manga fully colored or drawn in color.",
                "No Dialogue": "This work contains no dialogue.",
                "Non-fiction": "A work that provides information regarding a real world topic and does not focus on an imaginary narrative.",
                "POV": "Point of View; features scenes shown from the perspective of the series protagonist.",
                "Puppetry": "Animation style involving the manipulation of puppets to act out scenes.",
                "Rotoscoping": "Animation technique that animators use to trace over motion picture footage, frame by frame, to produce realistic action.",
                "Stop Motion": "Animation style characterized by physical objects being moved incrementally between frames to create the illusion of movement."
            },
            "Setting-Time": {
                "Achronological Order": "Chapters or episodes do not occur in chronological order.",
                "Anachronism": "Prominently features elements that are out of place in the historical period the work takes place in, particularly modern elements in a historical setting.",
                "Ancient China": "Setting in ancient china, does not apply to fantasy settings.",
                "Dystopian": "Partly or completely set in a society characterized by poverty, squalor or oppression.",
                "Historical": "Partly or completely set during a real period of world history.",
                "Time Skip": "Features a gap in time used to advance the story."
            },
            "Theme-Game-Sport": {
                "Acrobatics": "The art of jumping, tumbling, and balancing. Often paired with trapeze, trampolining, tightropes, or general gymnastics.",
                "Airsoft": "Centers around the sport of airsoft.",
                "American Football": "Centers around the sport of American football.",
                "Athletics": "Centers around sporting events that involve competitive running, jumping, throwing, or walking.",
                "Badminton": "Centers around the sport of badminton.",
                "Baseball": "Centers around the sport of baseball.",
                "Basketball": "Centers around the sport of basketball.",
                "Bowling": "Centers around the sport of Bowling.",
                "Boxing": "Centers around the sport of boxing.",
                "Cheerleading": "Centers around the activity of cheerleading.",
                "Cycling": "Centers around the sport of cycling.",
                "Fencing": "Centers around the sport of fencing.",
                "Fishing": "Centers around the sport of fishing.",
                "Fitness": "Centers around exercise with the aim of improving physical health.",
                "Football": "Centers around the sport of football (known in the USA as \"soccer\").",
                "Golf": "Centers around the sport of golf.",
                "Handball": "Centers around the sport of handball.",
                "Ice Skating": "Centers around the sport of ice skating.",
                "Judo": "Centers around the sport of judo.",
                "Lacrosse": "A team game played with a ball and lacrosse sticks.",
                "Parkour": "Centers around the sport of parkour.",
                "Rugby": "Centers around the sport of rugby.",
                "Scuba Diving": "Prominently features characters diving with the aid of special breathing equipment.",
                "Skateboarding": "Centers around or prominently features skateboarding as a sport.",
                "Sumo": "Centers around the sport of sumo.",
                "Surfing": "Centers around surfing as a sport.",
                "Swimming": "Centers around the sport of swimming.",
                "Table Tennis": "Centers around the sport of table tennis (also known as \"ping pong\").",
                "Tennis": "Centers around the sport of tennis.",
                "Volleyball": "Centers around the sport of volleyball.",
                "Wrestling": "Centers around the sport of wrestling."
            },
            "Theme-Arts": {
                "Acting": "Centers around actors or the acting industry.",
                "Calligraphy": "Centers around the art of calligraphy.",
                "Classic Literature": "Discusses or adapts a work of classic world literature.",
                "Drawing": "Centers around the art of drawing, including manga and doujinshi.",
                "Fashion": "Centers around the fashion industry.",
                "Food": "Centers around cooking or food appraisal.",
                "Makeup": "Centers around the makeup industry.",
                "Photography": "Centers around the use of cameras to capture photos.",
                "Rakugo": "Rakugo is the traditional Japanese performance art of comic storytelling.",
                "Writing": "Centers around the profession of writing books or novels."
            },
            "Theme-Other": {
                "Adoption": "Features a character who has been adopted by someone who is neither of their biological parents.",
                "Animals": "Prominently features animal characters in a leading role.",
                "Astronomy": "Relating or centered around the study of celestial objects and phenomena, space, or the universe.",
                "Autobiographical": "Real stories and anecdotes written by the author about their own life.",
                "Biographical": "Based on true stories of real persons living or dead, written by another.",
                "Body Horror": "Features characters who undergo horrific transformations or disfigurement, often to their own detriment.",
                "Cannibalism": "Prominently features the act of consuming another member of the same species as food.",
                "Chibi": "Features \"super deformed\" character designs with smaller, rounder proportions and a cute look.",
                "Cosmic Horror": "A type of horror that emphasizes human insignificance in the grand scope of cosmic reality; fearing the unknown and being powerless to fight it.",
                "Crime": "Centers around unlawful activities punishable by the state or other authority.",
                "Crossover": "Centers around the placement of two or more otherwise discrete fictional characters, settings, or universes into the context of a single story.",
                "Death Game": "Features characters participating in a game, where failure results in death.",
                "Denpa": "Works that feature themes of social dissociation, delusions, and other issues like suicide, bullying, self-isolation, paranoia, and technological necessity in daily lives. Classic iconography: telephone poles, rooftops, and trains.",
                "Drugs": "Prominently features the usage of drugs such as opioids, stimulants, hallucinogens etc.",
                "Economics": "Centers around the field of economics.",
                "Educational": "Primary aim is to educate the audience.",
                "Environmental": "Concern with the state of the natural world and how humans interact with it.",
                "Ero Guro": "Japanese literary and artistic movement originating in the 1930's. Works have a focus on grotesque eroticism, sexual corruption, and decadence.",
                "Filmmaking": "Centers around the art of filmmaking.",
                "Found Family": "Features a group of characters with no biological relations that are united in a group providing social support.",
                "Gambling": "Centers around the act of gambling.",
                "Gender Bending": "Prominently features a character who dresses and behaves in a way characteristic of another gender, or has been transformed into a person of another gender.",
                "Gore": "Prominently features graphic bloodshed and violence.",
                "Language Barrier": "A barrier to communication between people who are unable to speak a common language.",
                "LGBTQ+ Themes": "Prominently features characters or themes associated with the LGBTQ+ community, such as sexuality or gender identity.",
                "Lost Civilization": "Featuring a civilization with few ruins or records that exist in present day knowledge.",
                "Marriage": "Centers around marriage between two or more characters.",
                "Medicine": "Centered around the activities of people working in the field of medicine.",
                "Memory Manipulation": "Prominently features a character(s) who has had their memories altered.",
                "Meta": "Features fourth wall-breaking references to itself or genre tropes.",
                "Mountaineering": "Prominently features characters discussing or hiking mountains.",
                "Noir": "Stylized as a cynical crime drama with low-key visuals.",
                "Otaku Culture": "Centers around the culture of a fanatical fan-base.",
                "Pandemic": "Prominently features a disease prevalent over a whole country or the world.",
                "Philosophy": "Relating or devoted to the study of the fundamental nature of knowledge, reality, and existence.",
                "Politics": "Centers around politics, politicians, or government activities.",
                "Proxy Battle": "A proxy battle is a battle where humans use creatures/robots to do the fighting for them, either by commanding those creatures/robots or by simply evolving them/changing them into battle mode.",
                "Psychosexual": "Work that involves the psychological aspects of sexual impulses.",
                "Reincarnation": "Features a character being born again after death, typically as another person or in another world.",
                "Religion": "Centers on the belief that humanity is related to supernatural, transcendental, and spiritual elements.",
                "Royal Affairs": "Features nobility, alliances, arranged marriage, succession disputes, religious orders and other elements of royal politics.",
                "Slavery": "Prominently features slaves, slavery, or slave trade.",
                "Software Development": "Centers around characters developing or programming a piece of technology, software, gaming, etc.",
                "Survival": "Centers around the struggle to live in spite of extreme obstacles.",
                "Terrorism": "Centers around the activities of a terrorist or terrorist organization.",
                "Torture": "The act of deliberately inflicting severe pain or suffering upon another individual or oneself as a punishment or with a specific purpose.",
                "Travel": "Centers around character(s) moving between places a significant distance apart.",
                "War": "Partly or completely set during wartime."
            },
            "Setting-Universe": {
                "Afterlife": "Partly or completely set in the afterlife.",
                "Alternate Universe": "Features multiple alternate universes in the same series.",
                "Augmented Reality": "Prominently features events with augmented reality as the main setting.",
                "Omegaverse": "Alternative universe that prominently features dynamics modeled after wolves in which there are alphas, betas, and omegas and heat cycles as well as impregnation, regardless of gender.",
                "Post-Apocalyptic": "Partly or completely set in a world or civilization after a global disaster.",
                "Space": "Partly or completely set in outer space.",
                "Urban Fantasy": "Set in a world similar to the real world, but with the existence of magic or other supernatural elements.",
                "Virtual World": "Partly or completely set in the world inside a video game."
            },
            "Theme-Romance": {
                "Age Gap": "Prominently features romantic relations between people with a significant age difference.",
                "Bisexual": "Features a character who is romantically or sexually attracted to people of more than one sex or gender.",
                "Boys' Love": "Prominently features romance between two males, not inherently sexual.",
                "Female Harem": "Main cast features the protagonist plus several female characters who are romantically interested in them.",
                "Heterosexual": "Prominently features a romance between a man and a woman, not inherently sexual.",
                "Love Triangle": "Centered around romantic feelings between more than two people. Includes all love polygons.",
                "Male Harem": "Main cast features the protagonist plus several male characters who are romantically interested in them.",
                "Matchmaking": "Prominently features either a matchmaker or events with the intent of matchmaking with eventual marriage in sight.",
                "Mixed Gender Harem": "Main cast features the protagonist plus several people, regardless of gender, who are romantically interested in them.",
                "Teens' Love": "Sexually explicit love-story between individuals of the opposite sex, specifically targeting females of teens and young adult age.",
                "Unrequited Love": "One or more characters are experiencing an unrequited love that may or may not be reciprocated.",
                "Yuri": "Prominently features romance between two females, not inherently sexual. Also known as Girls' Love."
            },
            "Cast-Traits": {
                "Age Regression": "Prominently features a character who was returned to a younger state.",
                "Agender": "Prominently features agender characters.",
                "Aliens": "Prominently features extraterrestrial lifeforms.",
                "Amnesia": "Prominently features a character(s) with memory loss.",
                "Angels": "Prominently features spiritual beings usually represented with wings and halos and believed to be attendants of God.",
                "Anthropomorphism": "Contains non-human character(s) that have attributes or characteristics of a human being.",
                "Aromantic": "Features a character who experiences little to no romantic attraction.",
                "Arranged Marriage": "Features two characters made to marry each other, usually by their family.",
                "Artificial Intelligence": "Intelligent non-organic machines that work and react similarly to humans.",
                "Asexual": "Features a character who isn't sexually attracted to people of any sex or gender.",
                "Butler": "Prominently features a character who is a butler.",
                "Centaur": "Prominently features a character with a human upper body and the lower body of a horse.",
                "Chimera": "Features a beast made by combining animals, usually with humans.",
                "Chuunibyou": "Prominently features a character with \"Middle School 2nd Year Syndrome\", who either acts like a know-it-all adult or falsely believes they have special powers.",
                "Clone": "Prominently features a character who is an artificial exact copy of another organism.",
                "Cosplay": "Features dressing up as a different character or profession.",
                "Cowboys": "Features Western or Western-inspired cowboys.",
                "Crossdressing": "Prominently features a character dressing up as the opposite sex.",
                "Cyborg": "Prominently features a human character whose physiological functions are aided or enhanced by artificial means.",
                "Delinquents": "Features characters with a notorious image and attitude, sometimes referred to as \"yankees\".",
                "Demons": "Prominently features malevolent otherworldly creatures.",
                "Detective": "Features a character who investigates and solves crimes.",
                "Dinosaurs": "Prominently features Dinosaurs, prehistoric reptiles that went extinct millions of years ago.",
                "Disability": "A work that features one or more characters with a physical, mental, cognitive, or developmental condition that impairs, interferes with, or limits the person's ability to engage in certain tasks or actions.",
                "Dissociative Identities": "A case where one or more people share the same body.",
                "Dragons": "Prominently features mythical reptiles which generally have wings and can breathe fire.",
                "Dullahan": "Prominently features a character who is a Dullahan, a creature from Irish Folklore with a head that can be detached from its main body.",
                "Elf": "Prominently features a character who is an elf.",
                "Fairy": "Prominently features a character who is a fairy.",
                "Femboy": "Features a boy who exhibits characteristics or behaviors considered in many cultures to be typical of girls.",
                "Ghost": "Prominently features a character who is a ghost.",
                "Goblin": "A goblin is a monstrous creature from European folklore. They are almost always small and grotesque, mischievous or outright malicious, and greedy. Sometimes with magical abilities.",
                "Gods": "Prominently features a character of divine or religious nature.",
                "Gyaru": "Prominently features a female character who has a distinct American-emulated fashion style, such as tanned skin, bleached hair, and excessive makeup. Also known as gal.",
                "Hikikomori": "Prominently features a character who withdraws from social life, often seeking extreme isolation.",
                "Homeless": "Prominently features a character that is homeless.",
                "Idol": "Centers around the life and activities of an idol.",
                "Kemonomimi": "Prominently features humanoid characters with animal ears.",
                "Kuudere": "Prominently features a character who generally retains a cold, blunt and cynical exterior, but once one gets to know them, they have a very warm and loving interior.",
                "Maids": "Prominently features a character who is a maid.",
                "Mermaid": "A mythological creature with the body of a human and the tail of a fish.",
                "Monster Boy": "Prominently features a male character who is a part-monster.",
                "Monster Girl": "Prominently features a female character who is part-monster.",
                "Nekomimi": "Humanoid characters with cat-like features such as cat ears and a tail.",
                "Ninja": "Prominently features Japanese warriors traditionally trained in espionage, sabotage and assasination.",
                "Nudity": "Features a character wearing no clothing or exposing intimate body parts.",
                "Nun": "Prominently features a character who is a nun.",
                "Office Lady": "Prominently features a female office worker or OL.",
                "Oiran": "Prominently features a courtesan character of the Japanese Edo Period.",
                "Ojou-sama": "Features a wealthy, high-class, oftentimes stuck up and demanding female character.",
                "Orphan": "Prominently features a character that is an orphan.",
                "Pirates": "Prominently features sea-faring adventurers branded as criminals by the law.",
                "Robots": "Prominently features humanoid machines.",
                "Samurai": "Prominently features warriors of medieval Japanese nobility bound by a code of honor.",
                "Shrine Maiden": "Prominently features a character who is a shrine maiden.",
                "Skeleton": "Prominently features skeleton(s) as a character.",
                "Succubus": "Prominently features a character who is a succubus, a creature in medieval folklore that typically uses their sexual prowess to trap and seduce people to feed off them.",
                "Tanned Skin": "Prominently features characters with tanned skin.",
                "Teacher": "Protagonist is an educator, usually in a school setting.",
                "Tomboy": "Features a girl who exhibits characteristics or behaviors considered in many cultures to be typical of boys.",
                "Transgender": "Features a character whose gender identity differs from the sex they were assigned at birth.",
                "Tsundere": "Prominently features a character who acts cold and hostile in order to mask warmer emotions.",
                "Twins": "Prominently features two or more siblings that were born at one birth.",
                "Vampire": "Prominently features a character who is a vampire.",
                "Veterinarian": "Prominently features a veterinarian or one of the main characters is a veterinarian.",
                "Vikings": "Prominently features Scandinavian seafaring pirates and warriors.",
                "Villainess": "Centers around or prominently features a villainous noble lady.",
                "VTuber": "Prominently features a character who is either an actual or fictive VTuber.",
                "Werewolf": "Prominently features a character who is a werewolf.",
                "Witch": "Prominently features a character who is a witch.",
                "Yandere": "Prominently features a character who is obsessively in love with another, to the point of acting deranged or violent.",
                "Zombie": "Prominently features reanimated corpses which often prey on live humans and turn them into zombies."
            },
            "Theme-Slice of Life": {
                "Agriculture": "Prominently features agriculture practices.",
                "Cute Boys Doing Cute Things": "Centers around male characters doing cute activities, usually with little to no emphasis on drama and conflict.",
                "Cute Girls Doing Cute Things": "Centers around female characters doing cute activities, usually with little to no emphasis on drama and conflict.\n",
                "Family Life": "Centers around the activities of a family unit.",
                "Horticulture": "The story prominently features plant care and gardening.",
                "Iyashikei": "Primary aim is to heal the audience through serene depictions of characters' daily lives.",
                "Parenthood": "Centers around the experience of raising a child."
            },
            "Sexual Content": {
                "Ahegao": "Features a character making an exaggerated orgasm face.",
                "Amputation": "Features amputation or amputees.",
                "Anal Sex": "Features sexual penetration of the anal cavity.",
                "Armpits": "Features the sexual depiction or stimulation of a character's armpits.",
                "Ashikoki": "Footjob; features stimulation of genitalia by feet.",
                "Asphyxiation": "Features breath play.",
                "Blackmail": "Features a character blackmailing another into performing sexual acts.",
                "Bondage": "Features BDSM, with or without the use of accessories.",
                "Boobjob": "Features the stimulation of male genitalia by breasts.",
                "Cervix Penetration": "A sexual act in which the cervix is visibly penetrated.",
                "Cumflation": "The stomach area expands outward like a balloon due to being filled specifically with semen.",
                "Cunnilingus": "Features oral sex performed on female genitalia.",
                "Deepthroat": "Features oral sex where the majority of the erect male genitalia is inside another person's mouth, usually stimulating some gagging in the back of their throat.",
                "Defloration": "Features a female character who has never had sexual relations (until now).",
                "DILF": "Features sexual intercourse with older men.",
                "Double Penetration": "A sexual act in which the vagina/anus are penetrated by two penises/toys.",
                "Exhibitionism": "Features the act of exposing oneself in public for sexual pleasure.",
                "Facial": "Features sexual ejaculation onto an individual's face.",
                "Feet": "Features the sexual depiction or stimulation of a character's feet.",
                "Fellatio": "Blowjob; features oral sex performed on male genitalia.",
                "Femdom": "Female Dominance. Features sexual acts with a woman in a dominant position.",
                "Fisting": "A sexual activity that involves inserting one or more hands into the vagina or rectum.",
                "Flat Chest": "Features a female character with smaller-than-average breasts.",
                "Futanari": "Features female characters with male genitalia.",
                "Group Sex": "Features more than two participants engaged in sex simultaneously.",
                "Hair Pulling": "A sexual act in which the giver will grab the receivers hair and tug whilst giving pleasure from behind.",
                "Handjob": "Features the stimulation of genitalia by another's hands.",
                "Human Pet": "Features characters in a master-slave relationship where one is the \"owner\" and the other is a \"pet.\"",
                "Hypersexuality": "Portrays a character with a hypersexuality disorder, compulsive sexual behavior, or sex addiction.",
                "Incest": "Features sexual or romantic relations between characters who are related by blood.",
                "Inseki": "Features sexual or romantic relations among step, adopted, and other non-blood related family members.",
                "Irrumatio": "Oral rape; features a character thrusting their genitalia or a phallic object into the mouth of another character.",
                "Lactation": "Features breast milk play and production.",
                "Large Breasts": "Features a character with larger-than-average breasts.",
                "Male Pregnancy": "Features pregnant male characters in a sexual context.",
                "Masochism": "Prominently features characters who get sexual pleasure from being hurt or controlled by others.",
                "Masturbation": "Features erotic stimulation of one's own genitalia or other erogenous regions.",
                "Mating Press": "Features the sex position in which two partners face each other, with one of them thrusting downwards and the other's legs tucked up towards their head.",
                "MILF": "Features sexual intercourse with older women.",
                "Nakadashi": "Creampie; features sexual ejaculation inside of a character.",
                "Netorare": "NTR; features a character with a partner shown being intimate with someone else.",
                "Netorase": "Features characters in a romantic relationship who agree to be sexually intimate with others.",
                "Netori": "Features a character shown being intimate with the partner of another character. The opposite of netorare.",
                "Pet Play": "Treating a participant as though they were a pet animal. Often involves a collar and possibly BDSM.",
                "Pregnant": "Features pregnant female characters in a sexual context.",
                "Prostitution": "Features characters who are paid for sexual favors.",
                "Public Sex": "Features sexual acts performed in public settings.",
                "Rape": "Features non-consensual sexual penetration.",
                "Rimjob": "Features oral sex performed on the anus.",
                "Sadism": "Prominently features characters deriving pleasure, especially sexual gratification, from inflicting pain, suffering, or humiliation on others.",
                "Scat": "Lots of feces.",
                "Scissoring": "A form of sexual activity between women in which the genitals are stimulated by being rubbed against one another.",
                "Sex Toys": "Features objects that are designed to stimulate sexual pleasure.",
                "Squirting": "Female ejaculation; features the expulsion of liquid from the female genitalia.",
                "Sumata": "Pussyjob; features the stimulation of male genitalia by the thighs and labia majora of a female character.",
                "Sweat": "Lots of sweat.",
                "Tentacles": "Features the long appendages most commonly associated with octopuses or squid, often sexually penetrating a character.",
                "Threesome": "Features sexual acts between three people.",
                "Virginity": "Features a male character who has never had sexual relations (until now).",
                "Vore": "Features a character being swallowed or swallowing another creature whole.",
                "Voyeur": "Features a character who enjoys seeing the sex acts or sex organs of others.",
                "Watersports": "Features sexual situations involving urine.",
                "Zoophilia": "Features a character who has a sexual attraction for non-human animals."
            },
            "Theme-Fantasy": {
                "Alchemy": "Features character(s) who practice alchemy.",
                "Body Swapping": "Centers around individuals swapping bodies with one another.",
                "Cultivation": "Features characters using training, often martial arts-related, and other special methods to cultivate life force and gain strength or immortality.",
                "Fairy Tale": "This work tells a fairy tale, centers around fairy tales, or is based on a classic fairy tale.",
                "Henshin": "Prominently features character or costume transformations which often grant special abilities.",
                "Isekai": "Features characters being transported into an alternate world setting and having to adapt to their new surroundings.",
                "Kaiju": "Prominently features giant monsters.",
                "Magic": "Prominently features magical elements or the use of magic.",
                "Mythology": "Prominently features mythological elements, especially those from religious or cultural tradition.",
                "Necromancy": "When the dead are summoned as spirits, skeletons, or the undead, usually for the purpose of gaining information or to be used as a weapon.",
                "Shapeshifting": "Features character(s) who changes one's appearance or form.",
                "Steampunk": "Prominently features technology and designs inspired by 19th-century industrial steam-powered machinery.",
                "Super Power": "Prominently features characters with special abilities that allow them to do what would normally be physically or logically impossible.",
                "Superhero": "Prominently features super-powered humans who aim to serve the greater good.",
                "Wuxia": "Chinese fiction concerning the adventures of martial artists in Ancient China.",
                "Youkai": "Prominently features supernatural creatures from Japanese folklore."
            },
            "Cast-Main Cast": {
                "Anti-Hero": "Features a protagonist who lacks conventional heroic attributes and may be considered a borderline villain.",
                "Elderly Protagonist": "The protagonist is either over 60 years of age, has an elderly appearance, or, in the case of non-humans, is considered elderly for their species.",
                "Ensemble Cast": "Features a large cast of characters with (almost) equal screen time and importance to the plot.",
                "Estranged Family": "At least one family member of the MC intentionally distances themselves or a family distances themselves from a person related to the MC.",
                "Female Protagonist": "Main character is female.",
                "Male Protagonist": "Main character is male.",
                "Primarily Adult Cast": "Main cast is mostly composed of characters above a high school age.",
                "Primarily Animal Cast": "Main cast is mostly composed animal or animal-like characters.",
                "Primarily Child Cast": "Main cast is mostly composed of characters below a high school age.",
                "Primarily Female Cast": "Main cast is mostly composed of female characters.",
                "Primarily Male Cast": "Main cast is mostly composed of male characters.",
                "Primarily Teen Cast": "Main cast is mostly composed of teen characters."
            },
            "Theme-Action": {
                "Archery": "Centers around the sport of archery, or prominently features the use of archery in combat.",
                "Battle Royale": "Centers around a fierce group competition, often violent and with only one winner.",
                "Espionage": "Prominently features characters infiltrating an organization in order to steal sensitive information.",
                "Fugitive": "Prominently features a character evading capture by an individual or organization.",
                "Guns": "Prominently features the use of guns in combat.",
                "Martial Arts": "Centers around the use of traditional hand-to-hand combat.",
                "Spearplay": "Prominently features the use of spears in combat.",
                "Swordplay": "Prominently features the use of swords in combat."
            },
            "Theme-Other-Organisations": {
                "Assassins": "Centers around characters who murder people as a profession.",
                "Criminal Organization": "Prominently features a group of people who commit crimes for illicit or violent purposes.",
                "Cult": "Features a social group with unorthodox religious, spiritual, or philosophical beliefs and practices.",
                "Firefighters": "Centered around the life and activities of rescuers specialised in firefighting.",
                "Gangs": "Centers around gang organizations.",
                "Mafia": "Centered around Italian organised crime syndicates.",
                "Military": "Centered around the life and activities of military personnel.",
                "Police": "Centers around the life and activities of law enforcement officers.",
                "Triads": "Centered around Chinese organised crime syndicates.",
                "Yakuza": "Centered around Japanese organised crime syndicates."
            },
            "Theme-Other-Vehicle": {
                "Aviation": "Regarding the flying or operation of aircraft.",
                "Cars": "Centers around the use of automotive vehicles.",
                "Mopeds": "Prominently features mopeds.",
                "Motorcycles": "Prominently features the use of motorcycles.",
                "Ships": "Prominently features the use of sea-based transportation vessels.",
                "Tanks": "Prominently features the use of tanks or other armoured vehicles.",
                "Trains": "Prominently features trains."
            },
            "Theme-Arts-Music": {
                "Band": "Main cast is a group of musicians.",
                "Classical Music": "Centers on the musical style of classical, not to be applied to anime that use classical in its soundtrack.",
                "Dancing": "Centers around the art of dance.",
                "Hip-hop Music": "Centers on the musical style of hip-hop, not to be applied to anime that use hip-hop in its soundtrack.",
                "Jazz Music": "Centers on the musical style of jazz, not to be applied to anime that use jazz in its soundtrack.",
                "Metal Music": "Centers on the musical style of metal, not to be applied to anime that use metal in its soundtrack.",
                "Musical Theater": "Features a performance that combines songs, spoken dialogue, acting, and dance.",
                "Rock Music": "Centers on the musical style of rock, not to be applied to anime that use rock in its soundtrack."
            },
            "Setting-Scene": {
                "Bar": "Partly or completely set in a bar.",
                "Boarding School": "Features characters attending a boarding school.",
                "Circus": "Prominently features a circus.",
                "Coastal": "Story prominently takes place near the beach or around a coastal area/town. Setting is near the ocean.",
                "College": "Partly or completely set in a college or university.",
                "Desert": "Prominently features a desert environment.",
                "Dungeon": "Prominently features a dungeon environment.",
                "Foreign": "Partly or completely set in a country outside the country of origin.",
                "Inn": "Partially or completely set in an Inn or Hotel.",
                "Konbini": "Predominantly features a convenience store.",
                "Natural Disaster": "It focuses on catastrophic events of natural origin, such as earthquakes, tsunamis,  volcanic eruptions, and severe storms. These works often present situations of extreme danger in which the characters struggle to survive and overcome the adversity.",
                "Office": "Features people who work in a business office.",
                "Outdoor": "Centers around hiking, camping or other outdoor activities.",
                "Prison": "Partly or completely set in a prison.",
                "Restaurant": "Features a business that prepares and serves food and drinks to customers. Also encompasses cafes and bistros.",
                "Rural": "Partly or completely set in the countryside.",
                "School": "Partly or completely set in a primary or secondary educational institution.",
                "School Club": "Partly or completely set in a school club scene.",
                "Snowscape": "Prominently or partially set in a snowy environment.",
                "Urban": "Partly or completely set in a city.",
                "Work": "Centers around the activities of a certain occupation."
            },
            "Theme-Game": {
                "Board Game": "Centers around characters playing board games.",
                "E-Sports": "Prominently features professional video game competitions, tournaments, players, etc.",
                "Video Games": "Centers around characters playing video games."
            },
            "Theme-Drama": {
                "Bullying": "Prominently features the use of force for intimidation, often in a school setting.",
                "Class Struggle": "Contains conflict born between the different social classes. Generally between an dominant elite and a suffering oppressed group.",
                "Coming of Age": "Centers around a character's transition from childhood to adulthood.",
                "Conspiracy": "Contains one or more factions controlling or attempting to control the world from the shadows.",
                "Eco-Horror": "Utilizes a horrifying depiction of ecology to explore man and its relationship with nature.",
                "Fake Relationship": "When two characters enter a fake relationship that mutually benefits one or both involved.",
                "Kingdom Management": "Characters in these series take on the responsibility of running a town or kingdom, whether they take control of an existing one, or build their own from the ground up.",
                "Rehabilitation": "Prominently features the recovery of a character who became incapable of social life or work.",
                "Revenge": "Prominently features a character who aims to exact punishment in a resentful or vindictive manner.",
                "Suicide": "The act or an instance of taking or attempting to take one's own life voluntarily and intentionally.",
                "Tragedy": "Centers around tragic events and unhappy endings."
            },
            "Theme-Game-Card & Board Game": {
                "Card Battle": "Centers around individuals competing in card games.",
                "Go": "Centered around the game of Go.",
                "Karuta": "Centers around the game of karuta.",
                "Mahjong": "Centered around the game of mahjong.",
                "Poker": "Centers around the game of poker or its variations.",
                "Shogi": "Centers around the game of shogi."
            },
            "Theme-Sci-Fi": {
                "Cyberpunk": "Set in a future of advanced technological and scientific achievements that have resulted in social disorder.",
                "Space Opera": "Centers around space warfare, advanced technology, chivalric romance and adventure.",
                "Time Loop": "A character is stuck in a repetitive cycle that they are attempting to break out of. This is distinct from a manipulating time of their own choice.",
                "Time Manipulation": "Prominently features time-traveling or other time-warping phenomena.",
                "Tokusatsu": "Prominently features elements that resemble special effects in Japanese live-action shows"
            },
            Demographic: {
                "Josei": "Target demographic is adult females.",
                "Kids": "Target demographic is young children.",
                "Seinen": "Target demographic is adult males.",
                "Shoujo": "Target demographic is teenage and young adult females.",
                "Shounen": "Target demographic is teenage and young adult males."
            },
            Setting: {
                "Matriarchy": "Prominently features a country that is ruled by a Queen or a society that is dominated by female inheritance."
            },
            "Theme-Comedy": {
                "Parody": "Features deliberate exaggeration of popular tropes or a particular genre to comedic effect.",
                "Satire": "Prominently features the use of comedy or ridicule to expose and criticise social phenomena.",
                "Slapstick": "Prominently features comedy based on deliberately clumsy actions or embarrassing events.",
                "Surreal Comedy": "Prominently features comedic moments that defy casual reasoning, resulting in illogical events."
            },
            Cast: {
                 "Polyamorous": "Features a character who is in a consenting relationship with multiple people at one time."
            },
            "Theme-Sci-Fi-Mecha": {
                "Real Robot": "Prominently features mechanical designs loosely influenced by real-world robotics.",
                "Super Robot": "Prominently features large robots often piloted by hot-blooded protagonists."
            }
        }
        collectionToPut.tagInfo = tagInfo
        collectionToPut.tagInfoUpdateAt = 1706687489
    }

    let filters = await retrieveJSON("filters")
    const version = 5
    if (!isJsonObject(filters) || filters.version !== version || jsonIsEmpty(filters)) {
        self.postMessage({ status: "Getting Filters" })
        filters = {
            format: {
                "Anime": true,
                "TV": true,
                "Movie": true,
                "OVA": true,
                "TV Short": true,
                "Special": true,
                "ONA": true,
                "Manga": true,
                "One Shot": true,
                "Novel": true
            },
            "country of origin": {
                "JP": true,
                "CN": true,
                "KR": true,
                "TW": true
            },
            genre: {
                "Action": true,
                "Adventure": true,
                "Drama": true,
                "Sci-Fi": true,
                "Mystery": true,
                "Comedy": true,
                "Supernatural": true,
                "Fantasy": true,
                "Sports": true,
                "Romance": true,
                "Slice of Life": true,
                "Horror": true,
                "Psychological": true,
                "Thriller": true,
                "Ecchi": true,
                "Mecha": true,
                "Music": true,
                "Mahou Shoujo": true
            },
            tag: {
                "Space": true,
                "Crime": true,
                "Episodic": true,
                "Ensemble Cast": true,
                "Primarily Adult Cast": true,
                "Tragedy": true,
                "Travel": true,
                "Noir": true,
                "Guns": true,
                "Male Protagonist": true,
                "Cyberpunk": true,
                "Philosophy": true,
                "Found Family": true,
                "Terrorism": true,
                "Tomboy": true,
                "Martial Arts": true,
                "Cyborg": true,
                "Amnesia": true,
                "Cowboys": true,
                "Anti-Hero": true,
                "Gambling": true,
                "Yakuza": true,
                "Heterosexual": true,
                "Drugs": true,
                "Police": true,
                "Female Protagonist": true,
                "Cult": true,
                "Tanned Skin": true,
                "Nudity": true,
                "Circus": true,
                "Military": true,
                "Foreign": true,
                "Work": true,
                "Fugitive": true,
                "Incest": true,
                "Desert": true,
                "Steampunk": true,
                "Post-Apocalyptic": true,
                "Shounen": true,
                "Twins": true,
                "Aliens": true,
                "Slapstick": true,
                "Religion": true,
                "Body Horror": true,
                "Magic": true,
                "Urban Fantasy": true,
                "Conspiracy": true,
                "Witch": true,
                "Kuudere": true,
                "Bar": true,
                "Spearplay": true,
                "Swordplay": true,
                "American Football": true,
                "School": true,
                "Primarily Male Cast": true,
                "School Club": true,
                "Coming of Age": true,
                "Bullying": true,
                "Delinquents": true,
                "Josei": true,
                "College": true,
                "Love Triangle": true,
                "Unrequited Love": true,
                "Drawing": true,
                "Chibi": true,
                "Football": true,
                "Cars": true,
                "Rural": true,
                "Seinen": true,
                "CGI": true,
                "Rape": true,
                "Detective": true,
                "Revenge": true,
                "Memory Manipulation": true,
                "Adoption": true,
                "Medicine": true,
                "Politics": true,
                "Dissociative Identities": true,
                "Historical": true,
                "Orphan": true,
                "Time Skip": true,
                "Suicide": true,
                "Urban": true,
                "Torture": true,
                "Crossdressing": true,
                "Gore": true,
                "Ninja": true,
                "Super Power": true,
                "Cultivation": true,
                "Anachronism": true,
                "Primarily Child Cast": true,
                "Shapeshifting": true,
                "Kaiju": true,
                "Demons": true,
                "Estranged Family": true,
                "Femboy": true,
                "Gender Bending": true,
                "Assassins": true,
                "Pirates": true,
                "Ships": true,
                "Slavery": true,
                "War": true,
                "Gods": true,
                "Dystopian": true,
                "Prison": true,
                "Lost Civilization": true,
                "Food": true,
                "Samurai": true,
                "Monster Boy": true,
                "Anthropomorphism": true,
                "Henshin": true,
                "Artificial Intelligence": true,
                "Robots": true,
                "Animals": true,
                "Marriage": true,
                "Skeleton": true,
                "Dragons": true,
                "Espionage": true,
                "Monster Girl": true,
                "Fairy": true,
                "Trains": true,
                "Aromantic": true,
                "Clone": true,
                "Asexual": true,
                "Battle Royale": true,
                "Mermaid": true,
                "Time Manipulation": true,
                "Angels": true,
                "Musical Theater": true,
                "LGBTQ+ Themes": true,
                "Body Swapping": true,
                "Zombie": true,
                "Female Harem": true,
                "Acting": true,
                "Achromatic": true,
                "Transgender": true,
                "Tennis": true,
                "Boxing": true,
                "Parody": true,
                "Tsundere": true,
                "Primarily Teen Cast": true,
                "Butler": true,
                "Survival": true,
                "Gangs": true,
                "POV": true,
                "Mafia": true,
                "Denpa": true,
                "Disability": true,
                "Amputation": true,
                "Afterlife": true,
                "Vampire": true,
                "Nun": true,
                "Meta": true,
                "Surreal Comedy": true,
                "Isekai": true,
                "Educational": true,
                "Psychosexual": true,
                "Super Robot": true,
                "Mythology": true,
                "Tokusatsu": true,
                "Bisexual": true,
                "Boys' Love": true,
                "Achronological Order": true,
                "Real Robot": true,
                "Band": true,
                "Cosmic Horror": true,
                "Masturbation": true,
                "Archery": true,
                "Rehabilitation": true,
                "Motorcycles": true,
                "Virtual World": true,
                "Video Games": true,
                "Dungeon": true,
                "Primarily Female Cast": true,
                "Shoujo": true,
                "Reincarnation": true,
                "Proxy Battle": true,
                "Full CGI": true,
                "Chimera": true,
                "Rock Music": true,
                "Baseball": true,
                "Gyaru": true,
                "Hip-hop Music": true,
                "Swimming": true,
                "Age Gap": true,
                "Nekomimi": true,
                "Ojou-sama": true,
                "Hikikomori": true,
                "Family Life": true,
                "Cute Girls Doing Cute Things": true,
                "Teacher": true,
                "Iyashikei": true,
                "Aviation": true,
                "Alternate Universe": true,
                "Class Struggle": true,
                "Kemonomimi": true,
                "Yuri": true,
                "Yandere": true,
                "Space Opera": true,
                "Environmental": true,
                "Netorare": true,
                "Crossover": true,
                "Agriculture": true,
                "Wuxia": true,
                "Shrine Maiden": true,
                "Male Harem": true,
                "Fairy Tale": true,
                "Maids": true,
                "Dancing": true,
                "Homeless": true,
                "Dinosaurs": true,
                "Parenthood": true,
                "Werewolf": true,
                "Triads": true,
                "Royal Affairs": true,
                "Mountaineering": true,
                "Badminton": true,
                "Alchemy": true,
                "Idol": true,
                "Youkai": true,
                "Ancient China": true,
                "Dullahan": true,
                "Mahjong": true,
                "Classic Literature": true,
                "Go": true,
                "Ghost": true,
                "Board Game": true,
                "Card Battle": true,
                "Death Game": true,
                "Augmented Reality": true,
                "Male Pregnancy": true,
                "Volleyball": true,
                "Athletics": true,
                "Acrobatics": true,
                "Photography": true,
                "Snowscape": true,
                "Ice Skating": true,
                "Superhero": true,
                "Bondage": true,
                "Language Barrier": true,
                "Kingdom Management": true,
                "Boarding School": true,
                "Eco-Horror": true,
                "Outdoor": true,
                "Basketball": true,
                "Software Development": true,
                "Age Regression": true,
                "Economics": true,
                "Otaku Culture": true,
                "Prostitution": true,
                "Elf": true,
                "Goblin": true,
                "Writing": true,
                "Mixed Gender Harem": true,
                "Arranged Marriage": true,
                "Cosplay": true,
                "Restaurant": true,
                "Coastal": true,
                "Vore": true,
                "Mopeds": true,
                "Oiran": true,
                "Fashion": true,
                "Agender": true,
                "Golf": true,
                "Criminal Organization": true,
                "Karuta": true,
                "Surfing": true,
                "Airsoft": true,
                "Satire": true,
                "Fitness": true,
                "Cycling": true,
                "Office Lady": true,
                "Centaur": true,
                "Cannibalism": true,
                "Wrestling": true,
                "Kids": true,
                "Elderly Protagonist": true,
                "Advertisement": true,
                "Makeup": true,
                "Chuunibyou": true,
                "Necromancy": true,
                "Classical Music": true,
                "Inseki": true,
                "Fencing": true,
                "Fishing": true,
                "Astronomy": true,
                "Sadism": true,
                "Tanks": true,
                "Voyeur": true,
                "Defloration": true,
                "Virginity": true,
                "Fellatio": true,
                "Cunnilingus": true,
                "Rotoscoping": true,
                "Filmmaking": true,
                "Handball": true,
                "Primarily Animal Cast": true,
                "Veterinarian": true,
                "Teens' Love": true,
                "Horticulture": true,
                "Natural Disaster": true,
                "Autobiographical": true,
                "Anthology": true,
                "No Dialogue": true,
                "Lacrosse": true,
                "Villainess": true,
                "Konbini": true,
                "Calligraphy": true,
                "Poker": true,
                "Judo": true,
                "Human Pet": true,
                "Cheerleading": true,
                "Anal Sex": true,
                "Large Breasts": true,
                "Pandemic": true,
                "Cute Boys Doing Cute Things": true,
                "Parkour": true,
                "Succubus": true,
                "Table Tennis": true,
                "Masochism": true,
                "Ero Guro": true,
                "Time Loop": true,
                "MILF": true,
                "Metal Music": true,
                "Biographical": true,
                "Tentacles": true,
                "Polyamorous": true,
                "Skateboarding": true,
                "Shogi": true,
                "Rakugo": true,
                "Rugby": true,
                "Office": true,
                "E-Sports": true,
                "Inn": true,
                "Stop Motion": true,
                "Flash": true,
                "VTuber": true,
                "4-koma": true,
                "Futanari": true,
                "Hypersexuality": true,
                "Firefighters": true,
                "Nakadashi": true,
                "Sumo": true,
                "Vikings": true,
                "Group Sex": true,
                "Public Sex": true,
                "Handjob": true,
                "Scuba Diving": true,
                "Puppetry": true,
                "Sex Toys": true,
                "Non-fiction": true,
                "Netorase": true,
                "Ahegao": true,
                "Fake Relationship": true,
                "Threesome": true,
                "Matriarchy": true,
                "Feet": true,
                "Watersports": true,
                "Lactation": true,
                "Femdom": true,
                "Restaurant ": true,
                "Facial": true,
                "Boobjob": true,
                "Flat Chest": true,
                "Scissoring": true,
                "Jazz Music": true,
                "Scat": true,
                "Exhibitionism": true,
                "Blackmail": true,
                "Musical": true,
                "Bowling": true,
                "Pregnant": true,
                "Full Color": true,
                "DILF": true,
                "Netori": true,
                "Zoophilia": true,
                "Matchmaking": true,
                "Deepthroat": true,
                "Rimjob": true,
                "Irrumatio": true,
                "Armpits": true,
                "Cumflation": true,
                "Sweat": true,
                "Omegaverse": true,
                "Ashikoki": true,
                "Squirting": true,
                "Double Penetration": true,
                "Pet Play": true,
                "Asphyxiation": true,
                "Sumata": true,
                "Impersonation": true
            },
            "tag category": {
                "Setting-Universe": true,
                "Theme-Other": true,
                "Technical": true,
                "Cast-Main Cast": true,
                "Theme-Drama": true,
                "Theme-Action": true,
                "Theme-Sci-Fi": true,
                "Cast-Traits": true,
                "Theme-Other-Organisations": true,
                "Theme-Romance": true,
                "Setting-Scene": true,
                "Sexual Content": true,
                "Theme-Fantasy": true,
                "Demographic": true,
                "Theme-Comedy": true,
                "Theme-Game-Sport": true,
                "Theme-Arts": true,
                "Theme-Other-Vehicle": true,
                "Setting-Time": true,
                "Theme-Arts-Music": true,
                "Theme-Sci-Fi-Mecha": true,
                "Theme-Game": true,
                "Theme-Slice of Life": true,
                "Theme-Game-Card & Board Game": true,
                "Cast": true,
                "Setting": true
            },
            studio: {
                "Sunrise": true,
                "bones": true,
                "MADHOUSE": true,
                "Toei Animation": true,
                "Studio Gallop": true,
                "J.C. Staff": true,
                "Nippon Animation": true,
                "A.C.G.T.": true,
                "Studio Pierrot": true,
                "Production I.G": true,
                "Studio Comet": true,
                "GONZO": true,
                "Studio DEEN": true,
                "Gainax": true,
                "Tatsunoko Production": true,
                "OLM": true,
                "Tokyo Movie Shinsha": true,
                "Bee Train": true,
                "AIC": true,
                "Hal Film Maker": true,
                "Digital Frontier": true,
                "Xebec": true,
                "ZEXCS": true,
                "Daume": true,
                "Nomad": true,
                "Kyoto Animation": true,
                "Group TAC": true,
                "Seven Arcs": true,
                "Asread": true,
                "TMS Entertainment": true,
                "ufotable": true,
                "feel.": true,
                "Studio Flag": true,
                "Studio Matrix": true,
                "TNK": true,
                "Studio Fantasia": true,
                "Studio Ghibli": true,
                "MediaNet": true,
                "Ashi Productions": true,
                "Pastel": true,
                "Satelight": true,
                "Imagin": true,
                "Manglobe": true,
                "APPP": true,
                "I-move": true,
                "Arms": true,
                "Chaos Project": true,
                "GANSIS": true,
                "Tokyo Kids": true,
                "Horipro": true,
                "Palm Studio": true,
                "AIC Spirits": true,
                "Yumeta Company": true,
                "CoMix Wave": true,
                "Studio Hibari": true,
                "Shaft": true,
                "Dongwoo Animation": true,
                "Studio Silver": true,
                "TMS-Kyokuchi": true,
                "Radix": true,
                "Studio Live": true,
                "Ajiado": true,
                "Triangle Staff": true,
                "Amber Film Works": true,
                "E&G Films": true,
                "Picture Magic": true,
                "AIC A.S.T.A.": true,
                "M.S.C": true,
                "Tokyo Movie": true,
                "Magic Bus": true,
                "Animate Film": true,
                "Actas": true,
                "A Line": true,
                "Vistec Entertainment": true,
                "WAO World": true,
                "G&G Entertainment": true,
                "Studio 4°C": true,
                "Animate": true,
                "Plum": true,
                "Artland": true,
                "Telecom Animation Film": true,
                "Karaku": true,
                "Brain's Base": true,
                "Pioneer LDC": true,
                "Project Team Argos": true,
                "Artmic": true,
                "Eiken": true,
                "Trinet Entertainment": true,
                "SynergySP": true,
                "Topcraft": true,
                "Studio Junio": true,
                "Studio OX": true,
                "mobanimation": true,
                "Zero G Room": true,
                "KSS": true,
                "DR Movie": true,
                "Triple X": true,
                "SIDO": true,
                "Animation Planet": true,
                "Studio Rikka": true,
                "Graphinica": true,
                "Kyokuichi Tokyo Movie Shinsha": true,
                "Creators Dot Com": true,
                "Tezuka Productions": true,
                "Ekura Animal": true,
                "Kitty Film": true,
                "T.P.O": true,
                "K-Factory": true,
                "Planet": true,
                "Studio Guts": true,
                "Studio Kelmadick": true,
                "Character Plan": true,
                "diomedéa": true,
                "Remic": true,
                "Jade Animation": true,
                "Shin-Ei Animation": true,
                "Mook Animation": true,
                "Four Some": true,
                "SPE Visual Works": true,
                "Oh! Production": true,
                "Happinet Pictures": true,
                "Studio Nue": true,
                "T-UP": true,
                "Shogakukan-Shueisha Productions": true,
                "Agent 21": true,
                "Ginga Teikoku": true,
                "Studio Egg": true,
                "Genco": true,
                "Trans Arts": true,
                "Robot": true,
                "Mushi Production": true,
                "Horannabi": true,
                "Studio Signal": true,
                "The Answer Studio": true,
                "Square Pictures": true,
                "DNA": true,
                "Sanctuary": true,
                "Soei Shinsha": true,
                "Studio 88": true,
                "D.A.S.T. Corporation": true,
                "Daiei": true,
                "Azeta Pictures": true,
                "Hero": true,
                "Phoenix Entertainment": true,
                "Annapuru": true,
                "Studio Kyuuma": true,
                "Vega Entertainment": true,
                "Sunshine Corporation": true,
                "Studio Gazelle": true,
                "Ishimori Entertainment": true,
                "JCF": true,
                "Dangun Pictures": true,
                "Dynamic Planning": true,
                "Front Line": true,
                "Academy Productions": true,
                "Rikuentai": true,
                "Kokusai Eigasha": true,
                "Aubec": true,
                "RAMS": true,
                "Public & Basic": true,
                "BeSTACK": true,
                "Kaname Production": true,
                "DLE": true,
                "Ishikawa Pro": true,
                "Minami Machi Bugyousho": true,
                "Sanrio": true,
                "Synergy Japan": true,
                "Atelier Giga": true,
                "Tsuchida Productions": true,
                "P.A. Works": true,
                "Soeishinsha": true,
                "Lilix": true,
                "A-1 Pictures": true,
                "PPM": true,
                "Animation 21": true,
                "Jupiter Films": true,
                "Mu Animation Studio": true,
                "Anime R": true,
                "Studio Sign": true,
                "Tohokushinsha Film Corporation": true,
                "VAP": true,
                "Jacom": true,
                "Visual 80": true,
                "Watanabe Promotion": true,
                "Animation Staff Room": true,
                "Oxybot": true,
                "Studio Khara": true,
                "Studio Kikan": true,
                "Fairy Tale Co.": true,
                "Wako Production": true,
                "NAS": true,
                "Japan Taps": true,
                "Doga Kobo": true,
                "Shirogumi": true,
                "Amuse": true,
                "Studio Magara": true,
                "TV Asahi": true,
                "Knack Productions": true,
                "Think Corporation": true,
                "Studio Unicorn": true,
                "PrimeTime": true,
                "Toei Video": true,
                "Idea Factory": true,
                "ACC Production": true,
                "Anpro": true,
                "Circus Production": true,
                "White Fox": true,
                "Procidis": true,
                "Takahashi Studio": true,
                "Production Reed": true,
                "Hero Communication": true,
                "Kanaban Graphics": true,
                "Cinepix": true,
                "Studio Zero": true,
                "DAX International": true,
                "Asahi Production": true,
                "Grouper Production": true,
                "OB Planning": true,
                "Daewon Media": true,
                "REALTHING": true,
                "KeyEast": true,
                "Kinema Citrus": true,
                "Office AO": true,
                "Jinni's Animation Studios": true,
                "Zuiyou Eizou": true,
                "Marvy Jack": true,
                "No Side": true,
                "Bee Media": true,
                "Marza Animation Planet": true,
                "David Production": true,
                "AIC Plus+": true,
                "Telescreen BV": true,
                "Frontier Works": true,
                "SILVER LINK.": true,
                "Ripple Film": true,
                "NHK Enterprises": true,
                "Heewon Entertainment": true,
                "POLYGON PICTURES": true,
                "MI": true,
                "Milky Cartoon": true,
                "TYO Animations": true,
                "Triple A": true,
                "Puzzle Animation": true,
                "Picograph": true,
                "GoHands": true,
                "Studio Anima": true,
                "Studio Look": true,
                "Studio Signpost": true,
                "Hoods Entertainment": true,
                "Nippon Columbia": true,
                "Kachidoki Studio": true,
                "Shanghai Animation Film Studio": true,
                "Casio Entertainment": true,
                "Encourage Films": true,
                "Usagi.Ou": true,
                "Ordet": true,
                "Takara Tomy": true,
                "JM animation": true,
                "I.Toon": true,
                "Stingray": true,
                "Gathering": true,
                "Studio PuYUKAI": true,
                "Bridge": true,
                "dwarf": true,
                "Sovat Theater": true,
                "Automatic Flowers Studio": true,
                "studio A-CAT": true,
                "Ascension": true,
                "Union Cho": true,
                "Studio Crocodile": true,
                "Studio Colorido": true,
                "Shogakukan Music & Digital Entertainment": true,
                "Animaruya": true,
                "Purple Cow Studio Japan": true,
                "Trick Block": true,
                "P Productions": true,
                "AIC Build": true,
                "Rising Force": true,
                "Studio Gokumi": true,
                "Tele-Cartoon Japan": true,
                "8-bit": true,
                "Gokuusha": true,
                "Studio Bogey": true,
                "Studio Saki Makura": true,
                "Sparkly Key Animation": true,
                "Hong Ying Animation": true,
                "Wonder Kids": true,
                "Lerche": true,
                "I was a Ballerina": true,
                "Shinano Kikaku": true,
                "MooGoo": true,
                "B&T": true,
                "Sega Toys": true,
                "project No.9": true,
                "Studio Blanc": true,
                "Studio Deva Loka": true,
                "Seven": true,
                "Studio Animal": true,
                "aNCHOR": true,
                "SANZIGEN": true,
                "Nakamura Production": true,
                "Ryukyu Asahi Broadcasting": true,
                "LMD": true,
                "indigo line": true,
                "Studio Pastoral": true,
                "Bouncy": true,
                "C2C": true,
                "Studio Chizu": true,
                "MAPPA": true,
                "LandQ studios": true,
                "Production IMS": true,
                "Sparky Animation": true,
                "NHK": true,
                "DAX Production": true,
                "Hotline": true,
                "Tomason": true,
                "We've": true,
                "Spooky graphic": true,
                "Atelier Bitol": true,
                "Larx Entertainment": true,
                "Po10tial": true,
                "Egg": true,
                "Lifework": true,
                "teamKG": true,
                "Trigger": true,
                "AIC Frontier": true,
                "Sola Digital Arts": true,
                "Studio KAI": true,
                "marone": true,
                "Passione": true,
                "LIDENFILMS": true,
                "Orange": true,
                "Otogi Production": true,
                "An DerCen": true,
                "Venet": true,
                "Kenji Studio": true,
                "Wit Studio": true,
                "Barnum Studio": true,
                "Vasoon Animation": true,
                "Animation 501": true,
                "Xebec Zwei": true,
                "Millepensee": true,
                "3D Co.": true,
                "Toho": true,
                "Mirai Film": true,
                "Wolf Smoke Studio": true,
                "ILCA": true,
                "Tama Production": true,
                "Creative Bridge": true,
                "Opera House": true,
                "Fanworks": true,
                "Fuji TV": true,
                "KAGAYA Studio": true,
                "Lay-duce": true,
                "NAZ": true,
                "DropWave": true,
                "Benesse Corporation": true,
                "10GAUGE": true,
                "C-Station": true,
                "Tri-Slash": true,
                "TROYCA": true,
                "Yaoyorozu": true,
                "Shuka": true,
                "Cyclone Graphics": true,
                "Studio 3Hz": true,
                "Aniplex": true,
                "Heartbit": true,
                "Lantis": true,
                "Creators in Pack": true,
                "CONNECT": true,
                "Strawberry Meets Pictures": true,
                "STEVE N' STEVEN": true,
                "Geno Studio": true,
                "A-Real": true,
                "Sega Games": true,
                "Bandai Namco Pictures": true,
                "Poncotan": true,
                "3xCube": true,
                "Studio VOLN": true,
                "Studio! Cucuri": true,
                "EMT Squared": true,
                "Nexus": true,
                "Sakura Create": true,
                "Kamikaze Douga": true,
                "office DCI": true,
                "Tomovies": true,
                "Studio Dice": true,
                "Signal.MD": true,
                "ENGI": true,
                "Qualia Animation": true,
                "AXsiZ": true,
                "CygamesPictures": true,
                "Kyotoma": true,
                "Pollyanna Graphics Inc": true,
                "Fortes": true,
                "Team YokkyuFuman": true,
                "Buemon": true,
                "PINE JAM": true,
                "Gaina": true,
                "Symphonium": true,
                "Koo-Ki": true,
                "GEMBA": true,
                "DMM.futureworks": true,
                "W-Toon Studio": true,
                "Joker Films": true,
                "Lapin Track": true,
                "NUT": true,
                "Studio LAN": true,
                "Zero-G": true,
                "Infinite": true,
                "Neft Film": true,
                "Pie in the sky": true,
                "Square Enix": true,
                "REVOROOT": true,
                "Juumonji": true,
                "Felix Film": true,
                "EGG FIRM": true,
                "production doA": true,
                "G.CMay Animation & Film": true,
                "Pandanium": true,
                "Tengu Kobou": true,
                "Issen": true,
                "PRA": true,
                "Platinum Vision": true,
                "Studio M2": true,
                "NAMU Animation": true,
                "BLADE": true,
                "Domerica": true,
                "Tetra": true,
                "Haoliners Animation": true,
                "TYPHOON GRAPHICS": true,
                "Science SARU": true,
                "CALF": true,
                "Studio Ponoc": true,
                "Yokohama Animation Lab": true,
                "Success": true,
                "Pili International Multimedia": true,
                "Imagineer": true,
                "Prhythm Vision": true,
                "drop": true,
                "Big Firebird Cultural Media": true,
                "Children's Playground Entertainment": true,
                "Dandelion Animation Studio": true,
                "Craftar": true,
                "CloverWorks": true,
                "NEXT Animation Studio": true,
                "Twilight Studio": true,
                "Shimogumi": true,
                "Foch": true,
                "ChuChu": true,
                "GEEKTOYS": true,
                "Dynamo Pictures": true,
                "Bibury Animation Studios": true,
                "FLAT STUDIO": true,
                "Studio Flad": true,
                "Wawayu Animation": true,
                "Yaoqi": true,
                "EBS": true,
                "Thundray": true,
                "Colored Pencil Animation": true,
                "B.CMAY PICTURES": true,
                "L² Studio": true,
                "Qiying Animation": true,
                "Rainbridge Animation": true,
                "CLAP": true,
                "iDRAGONS Creative Studio": true,
                "YAMATOWORKS": true,
                "Hangzhou Shimei Pictures": true,
                "Imagica": true,
                "Studio Nanahoshi": true,
                "Picona Creative Studio": true,
                "Magia Doraglier": true,
                "XFLAG PICTURES": true,
                "Helo": true,
                "Charaction": true,
                "Studio Dadashow": true,
                "EKACHI EPILKA": true,
                "2:10 Animation": true,
                "Drive": true,
                "Digital Network Animation": true,
                "UWAN Pictures": true,
                "Ezo’la": true,
                "Okuruto Noboru": true,
                "East Fish Studio": true,
                "Production +h": true,
                "Lesprit": true,
                "Sunflowers": true,
                "TriF studio": true,
                "Ruo Hong Culture": true,
                "Pb Animation": true,
                "Magilm Pictures": true,
                "Feng Donghua Culture": true,
                "Transcendence Picture": true,
                "Kun Animation & Comic": true,
                "Build Dream": true,
                "Light Chaser Animation": true,
                "Saetta": true,
                "Rocen": true,
                "October Media": true,
                "Wulifang Animation": true,
                "Studio Ugoki": true,
                "Seven Stone Entertainment": true,
                "LICO": true,
                "Jiang Toon Animation": true,
                "Dawn Picture": true,
                "Motion Magic": true,
                "YHKT Entertainment": true,
                "CG Year": true,
                "ASK Animation Studio": true,
                "GARDEN": true,
                "Shanghai Longcang Cultural Creative Company": true,
                "HMCH": true,
                "l-a-unch・BOX": true,
                "Crius Animation": true,
                "Coastline Animation Studio": true,
                "Digital Media Lab": true,
                "Nice Boat Animation": true,
                "Gudong Animation Studio": true,
                "Bright Studio": true,
                "Yi Chen Animation": true,
                "Mili Pictures": true,
                "7doc": true,
                "TUBAn": true,
                "FENZ": true,
                "E-DEHI Animation Studio": true,
                "exsa": true,
                "Echoes": true,
                "One & All Animation Studio": true,
                "Arvo Animation": true,
                "Master Lights": true,
                "monofilmo": true,
                "Qiyuan Yinghua": true,
                "Tear-Studio": true,
                "Imagica Lab.": true,
                "Yudubai Animation": true,
                "Acca effe": true,
                "Giga Production": true,
                "Qianqi Cartoon": true,
                "CCTV Animation": true,
                "MAKING ANIMATION": true,
                "Sublimation": true,
                "Polygon Magic": true,
                "Asura Film": true,
                "Sprite Animation Studios": true,
                "Lide": true,
                "Visual Flight": true,
                "Chiptune": true,
                "ODDJOB": true,
                "Samsara Studio": true,
                "Creative Power Entertaining": true,
                "Gekigadan": true,
                "Maro Studio": true,
                "Flying Ship Studio": true,
                "Keica": true,
                "Griot Groove": true,
                "Soyep": true,
                "BYMENT": true,
                "BAKKEN RECORD": true,
                "CHOSEN": true,
                "Daysview Animation": true,
                "Sharefun Studio": true,
                "Maho Film": true,
                "MMT": true,
                "Studio Bind": true,
                "Anima&Co. ": true,
                "HORNETS": true,
                "Magic Lantern Film": true,
                "Djinn Power": true,
                "Shengying Animation": true,
                "GRIZZLY": true,
                "Dazzling Star": true,
                "Studio Durian": true,
                "Qubic Pictures": true,
                "CGCG Studio Inc.": true,
                "Green Monster Team": true,
                "Kaca Entertainment": true,
                "Kigumi": true,
                "Choirock": true,
                "G-angle": true,
                "Planet Cartoon": true,
                "TIA": true,
                "Stella Promotion": true,
                "Monster's Egg": true,
                "Zhuo Hua Network": true,
                "Studio elle": true,
                "Coco Cartoon": true,
                "Taikong Works": true,
                "Maten Animation": true,
                "Sunrise Beyond": true,
                "Asatsu DK": true,
                "GAINAX Kyoto": true,
                "Hot Zipang ": true,
                "Akatsuki": true,
                "Space Neko Company": true,
                "Piso Studio": true,
                "Gakken": true,
                "WolfsBane": true,
                "Super Normal Studio": true,
                "BigBigSun": true,
                "I.G Zwei": true,
                "studio MOTHER": true,
                "FLAGSHIP LINE": true,
                "The Monk Studios": true,
                "Keika Co. Ltd.": true,
                "AQUA ARIS": true,
                "Arect": true,
                "LIDENFILMS Kyoto Studio": true,
                "SUSPENDERS": true,
                "ALBACROW": true,
                "Blaze Studio": true,
                "Lunch Box": true,
                "studio CANDY BOX": true,
                "Chongzhuo Animation": true,
                "LX Animation Studio": true,
                "Paper Plane Animation Studio": true,
                "Aqua Entertainment": true,
                "Lingsanwu Animation": true,
                "Children's Playground Creative": true,
                "Cheer Digiart": true,
                "Yostar Pictures": true,
                "Cloud Art": true,
                "Rastar": true,
                "Yamamura Animation, Inc.": true,
                "Speed": true,
                "Studio Goindol": true,
                "FILMONY": true,
                "Gosay Studio": true,
                "happyproject": true,
                "33 Collective": true,
                "Painting Dream": true,
                "Original Force": true,
                "Wonder Cat Animation": true,
                "TWR Entertainment": true,
                "Fatchi Moxie Studio": true,
                "TRCARTOON": true,
                "Tsukimidou": true,
                "Liberty Animation Studio": true,
                "Team Yamahitsuji": true,
                "Team Till Dawn": true,
                "Directions": true,
                "Xiaoying Feiyang Pictures": true,
                "Axis Studios": true,
                "Spell Bound": true,
                "Year Young Culture": true,
                "Sotsu": true,
                "Cover Corp": true,
                "Makaria": true,
                "Durufix": true,
                "Elite Animation": true,
                "Wind Under the Wings": true,
                "GYORAI EIZO": true,
                "Meditation With a Pencil": true,
                "Pancake": true,
                "Studio Compile": true,
                "Grimae Animation Studio": true,
                "Seoul Movie": true,
                "DRAWIZ": true,
                "D.ROCK-ART": true,
                "IDREAM Entertainment": true,
                "TMX Art": true,
                "Zhongce Picture": true,
                "Oriental Creative Color": true,
                "Mote Stop-Motion Animation": true,
                "Aisi Animation Studio": true,
                "JJJoy Animation Studios": true,
                "Sansan Studio": true,
                "Hangil Production": true,
                "DC Impression Vision": true,
                "Joicy Studio": true,
                "SYOK Studio": true,
                "STANDTOWER": true,
                "Dreambox Studio": true,
                "Sakura Eiga": true,
                "Great Dreams Cartoon": true,
                "Dwango": true,
                "Studio Tumble": true,
                "Studio JEMI": true,
                "Gift-o’-Animation": true,
                "Forest Hunting One": true,
                "FILMKO": true,
                "Visual Persistence": true,
                "Adnero": true,
                "Colored Pencil Animation Japan": true,
                "Base Media": true,
                "Panda Tower Studio": true,
                "Realwood Studios": true,
                "Dancing CG Studio": true,
                "BONEDD": true,
                "Tencent Penguin Pictures": true,
                "WinSing Animation": true,
                "Zoland Animation": true,
                "Korean Academy of Film Arts": true,
                "One Punch": true,
                "Boruntong": true,
                "Gold Valley Films": true,
                "Red Whale Studios": true,
                "Saiji": true,
                "Tyhoo CG": true,
                "Charming Fox Animation": true,
                "Fast Snail": true,
                "Quebico": true,
                "TANOism": true,
                "Infinity Vision": true,
                "White Paper Animation": true,
                "HM Heros": true,
                "Xinglü Animation": true,
                "Liyu Culture": true,
                "Unity of Knowledge and Action Animation": true,
                "Xuni Pictures": true,
                "Delight Animation": true,
                "Painted Edge": true,
                "SJYNEXCUS": true,
                "Original Dream": true,
                "KIO STUDIO": true,
                "717 Studio": true,
                "Take-Y Inc.": true,
                "Hyoin Entertainment": true,
                "Red Dog Culture House": true,
                "TECARAT": true,
                "P.I.C.S.": true,
                "ManHoo Culture": true,
                "1IN": true,
                "Star Hunter Animation": true,
                "ITS CARTOON": true,
                "Arc Anime": true,
                "Taomee": true,
                "Tiantai Animation": true,
                "Yi Animation": true,
                "miHoYo Anime": true,
                "wonderium": true,
                "Escape Velocity Animation": true,
                "Infinity Animation": true,
                "Transistor Studio": true,
                "Studio Palette": true,
                "Cocktail Media": true,
                "iQIYI": true,
                "Image Stream": true,
                "OZ": true,
                "Studio Kafka": true,
                "Coyote": true,
                "Yinhe Changxing Culture": true,
                "Tsubasa Production": true,
                "Heart & Soul Animation": true,
                "Xiyang Culture": true,
                "TThunDer Animation": true,
                "Doumu Animation": true,
                "Reike Eyes Animation": true,
                "Ten Tails Animation": true,
                "SAMG Animation": true,
                "Gambit": true,
                "studio daisy": true,
                "pH Studio": true,
                "Jumondou": true,
                "Atoonz": true,
                "Noovo Inc.": true,
                "Laftel": true,
                "Picsys": true,
                "Jichitai Anime": true,
                "INDIVISION": true,
                "Sorajima Studio": true,
                "studio TNT": true,
                "Passion Paint Animation": true,
                "Xing Yi Kai Chen": true,
                "GA-CREW": true,
                "BETOBE": true,
                "HuaMei Animation": true,
                "studio hb": true,
                "5 Inc.": true,
                "Atelier Pontdarc": true,
                "Quad": true,
                "CMC Media": true,
                "Shogakukan": true,
                "VCRWORKS": true,
                "Coloroom Pictures": true,
                "STEREOTYPE Inc.": true,
                "BlueArc Animation Studio": true,
                "Pai Naodai Animation": true,
                "Medo": true,
                "Aurora": true,
                "Fengyun Animation": true,
                "Yixiang Culture": true,
                "Yofox Culture": true,
                "BooKong Culture": true,
                "Paintfree": true,
                "Max-World": true,
                "Original Heart": true,
                "Burning Animation": true,
                "Fever Creations": true,
                "Studio Add": true,
                "Story Effect": true,
                "PPURI": true,
                "Stellation": true,
                "MagiDian": true,
                "EXNOA": true,
                "Live2D Creative Studio": true,
                "Bibury Animation CG": true,
                "Chongliyuhua": true,
                "Ruichen Pictures": true,
                "Coco Legends": true,
                "Village Studio": true,
                "Scooter Films": true,
                "Global Digital Creations": true,
                "GritWorld": true,
                "Studio Lings": true,
                "Simage Animation": true,
                "Observatory Animation": true,
                "Studio Pasa": true,
                "Project Studio Q": true,
                "Shouchiku": true,
                "Gravity Well": true,
                "Jinnan Studio": true,
                "Pass Media": true,
                "Alfred Imageworks": true,
                "ENISHIYA": true,
                "Thunder River": true,
                "Maple Toon": true,
                "MOJO": true,
                "Shenfan Animation": true,
                "He Zhou Culture": true,
                "Wenzhou Mengbu Anime Design": true,
                "Origin Chasing": true,
                "Hui Guang Studio": true,
                "Kungfufrog Animation": true,
                "Studio Mindo": true,
                "APEX VISION": true,
                "Hua Dream": true,
                "Flint Sugar": true,
                "Hayabusa Film": true,
                "UOU Studio": true,
                "Sheng Guang Qishi Tuan": true,
                "CompTown": true,
                "Teddy": true,
                "Plott": true,
                "MMDGP": true,
                "Studio Massket": true,
                "Tang Kirin Culture": true,
                "Universal Star Animation": true,
                "Soular Animation": true,
                "NOKID": true,
                "TCJ": true,
                "Geidai Animation": true,
                "Studio G-1Neo": true,
                "Amineworks": true,
                "ORENDA": true,
                "Fantasier Animation": true,
                "Staple Entertainment": true,
                "Gekkou": true,
                "Shenman Entertainment": true,
                "MontBlanc Pictures": true,
                "Contrail": true,
                "Block 12": true,
                "Duoling Cartoon": true,
                "BUG FILMS": true,
                "STUDIO 6'oN": true,
                "CLOUDHEARTS": true,
                "Tomoyasu Murata Company": true,
                "yell": true,
                "Fantawild Animation": true,
                "Jintu Pictures": true,
                "Studio 8 Dogs": true,
                "UchuPeople": true,
                "STUDIO SOTA": true,
                "Qingxiang": true,
                "EOTA": true,
                "Liber": true,
                "Da Yu": true,
                "E&H Production": true,
                "Alpha Animation": true,
                "Xiaoming Taiji": true,
                "Dejavu Media": true,
                "Skyloong": true,
                "j-cube": true,
                "Soda Bear Animation": true,
                "Cloud Culture": true,
                "PAPA ": true,
                "Mind Wind Studio": true,
                "Number 19 Animation": true,
                "Steam Works": true,
                "Tide Boy": true,
                "Kyoto Seika University": true,
                "Yasuda Genshou Studio by Xenotoon": true,
                "Gale": true,
                "FIREBUG": true,
                "Vooz Character System": true,
                "Xiaolan Friends": true,
                "Shangshui Original": true,
                "Honglu Technology": true,
                "Bytehoo": true,
                "Ijigen TOKYO": true,
                "IMAGICA DIGITALSCAPE": true,
                "Gen Long Culture": true,
                "Wu Zhi Guanying Dongman": true,
                "Space Shell": true,
                "BeDream": true,
                "Green Planet Studio": true,
                "Phantom": true,
                "Soul Stone Animation Studio": true,
                "Shi Qi Yu Mo": true,
                "Mili Digital": true,
                "Tsumugi Akita Anime Lab": true,
                "Pingo Entertainment": true,
                "Voil": true,
                "Studio Mir": true,
                "Miyu Productions": true,
                "Boundary": true,
                "TOHO animation STUDIO": true,
                "Fugaku": true,
                "REGARO": true,
                "Bandai Namco Filmworks": true,
                "Netflix Anime Creators' Base": true,
                "Qzil.la": true,
                "evg": true,
                "Marubeni": true,
                "Next Media Animation": true,
                "soket": true,
                "maroyaka": true,
                "UNEND": true,
                "Studio Fusion": true,
                "100studio": true,
                "Studio N": true,
                "Studio W.Baba": true,
                "Xtorm": true,
                "Thymos Media": true,
                "Saber Project": true,
                "G.S. Pictures Animation": true,
                "Chuangqi Studio": true,
                "YOYOmiracle": true,
                "XMOV": true,
                "Xiaoxiang Pictures": true,
                "Mandrill Picture Corp": true,
                "Orcen": true,
                "Pure Arts": true,
                "Fishing Cat Culture": true,
                "Sasayuri": true,
                "SAFEHOUSE": true,
                "ROLL2": true,
                "Ke Yue Xue Zi": true,
                "Liliyabi": true,
                "KUAIYING": true,
                "Fun Media": true,
                "Anyzac": true,
                "Tama Art University": true,
                "Imagica Infos": true,
                "Point Pictures": true,
                "Ocon Studios": true,
                "PIERROT FILMS": true,
                "Team OneOne": true,
                "Starry Cube": true,
                "STUDIO POLON": true,
                "Mainichi Eigasha": true,
                "Anime Tokyo": true,
                "BloomZ": true,
                "MOE": true,
                "Campfire Aniworks": true,
                "Alke": true,
                "Andraft": true,
                "Studio Houkiboshi": true,
                "Creative House Pocket": true,
                "Elias": true,
                "Hurray!": true,
                "KONAMI animation": true,
                "Chuangpu Animation Studio": true,
                "MANAA ANIMATION": true,
                "miHoYo": true,
                "Saber Works": true,
                "STUDIO EIGHTCOLORS": true,
                "REILS": true,
                "Soigne": true,
                "maxilla": true,
                "Youku": true,
                "Studio Outrigger": true,
                "GEAR STUDIO": true,
                "Imageworks Studio": true,
                "YAMATO WORKS": true,
                "Rouseact": true
            },
            year: Array.from({ length: new Date().getFullYear() - 1939 + 1 }, (_, index) => 1940 + index).reduce((acc, year) => {
                acc[year] = true;
                return acc;
            }, {}),
            "release status": {
                "Finished": true,
                "Releasing": true,
                "Cancelled": true,
                "Not Yet Released": true,
                "Hiatus": true
            },
            "user status": {
                "Completed": true,
                "Current": true,
                "Dropped": true,
                "Paused": true,
                "Planning": true,
                "Repeating": true,
                "Unseen": true,
            },
            version
        }
        collectionToPut.shouldProcessRecommendation = true
        collectionToPut.filters = filters
    }

    const orderedFilters = {
        sortFilter: [
            "weighted score",
            "score",
            "average score",
            "user score",
            "popularity",
            "trending",
            "date",
            "date updated",
            "date added",
            "favorites",
        ],
        season: [
            "current season",
            "next season",
            "previous season",
            "ongoing seasons",
            "future seasons",
            "past seasons",
            "Winter",
            "Spring",
            "Summer",
            "Fall",
        ],
        "flexible inclusion": [
            "OR: genre",
            "OR: tag",
            "OR: studio",
            "OR: genre / tag",
            "OR: genre / studio",
            "OR: tag / studio",
            "OR: genre / tag / studio",
        ],
        "shown metric": [
            "weighted score",
            "score",
            "average score",
            "user score",
            "popularity",
            "favorites",
            "trending",
        ],
        "shown list": [
            "recommended studios",
            "non-caution",
            "non-semi-caution",
            "recommended score",
            "semi-recommended score",
            "other",
        ]
    }
    const orderedFiltersKeys = ["genre", "tag", "tag category", "year", "format", "country of origin", "release status", "user status", "studio"]
    const optionsSort = {
        year: "descnum",
        format: { Special: 9, "One Shot": 8, ONA: 7, OVA: 6, "TV Short": 5, Movie: 4, TV: 3, Novel: 2, Manga: 1, Anime: 0 },
        "country of origin": { TW: 3, CN: 2, KR: 1, JP: 0 },
    }
    const algorithmFilterSelections = { genre: 1, tag: 1, "tag category": 1 }
    for (let i = 0, l = orderedFiltersKeys.length; i < l; i++) {
        const filterKey = orderedFiltersKeys[i], isAlgorithmFilterSelection = algorithmFilterSelections[filterKey]
        let options = Object.keys(filters[filterKey]);
        options = options.reduce((uniqueOptions, k) => {
            if (!uniqueOptions[k]) {
                uniqueOptions[k] = 1
            }
            return uniqueOptions;
        }, {})
        if (isAlgorithmFilterSelection) {
            delete options["All"]
            options = Object.keys(options)
        } else {
            options = Object.keys(options)
        }
        let optionSort = optionsSort[filterKey]
        if (optionSort === "descnum") {
            options.sort((a, b) => parseFloat(b) - parseFloat(a))
            // }  else if (optionSort === "ascnum") {
            //     options.sort((a, b) => parseFloat(a) - parseFloat(b))
            // } else if (optionSort === "desclet") {
            //     options.sort((a, b) => a.localeCompare(b, undefined, {sensitivity: 'base'}))
            //     options.reverse()
        } else if (isJsonObject(optionSort)) {
            options.sort((a, b) => {
                const optionSortA = optionSort[a];
                const optionSortB = optionSort[b];
            
                const isNumberA = typeof optionSortA === 'number';
                const isNumberB = typeof optionSortB === 'number';
            
                if (isNumberA && isNumberB) {
                    return optionSortA - optionSortB;
                }
            
                if (isNumberA) {
                    return -1;
                }
            
                if (isNumberB) {
                    return 1;
                }
            
                const isStringA = typeof a === 'string';
                const isStringB = typeof b === 'string';
            
                if (isStringA && isStringB) {
                    return a.localeCompare(b, undefined, {sensitivity: 'base'});
                }
            
                if (isStringA) {
                    return -1;
                }
            
                if (isStringB) {
                    return 1;
                }
            
                return 0;
            });
        } else {
            options.sort((a, b) => a.localeCompare(b, undefined, {sensitivity: 'base'})) // default ascending
        }
        if (isAlgorithmFilterSelection) {
            options.unshift("All")
        }
        orderedFilters[filterKey] = options
    }

    const nonOrderedFilters = {
        "Media Filter": {
            bool: [
                "hide my list",
                "hide my finished list",
                "show my list",
                "show all sequels",
                "show next sequel",
                "show anime adapted",
                "has unseen progress",
                "hidden list",
            ],
            number: [
                {
                    name: "average score",
                    maxValue: Infinity,
                    minValue: 0,
                },
                {
                    name: "user score",
                    maxValue: Infinity,
                    minValue: 0,
                },
                {
                    name: "year",
                    max: Infinity,
                    min: 0,
                },
                {
                    name: "popularity",
                    maxValue: Infinity,
                    minValue: 0,
                },
                {
                    name: "score",
                    maxValue: Infinity,
                    minValue: 0,
                },
                {
                    name: "weighted score",
                    max: Infinity,
                    min: 0,
                },
            ]
        },
        "Algorithm Filter": {
            bool: [
                "content focused",
                "inc. average score",
                "inc. all factors",
                "exclude year",
            ],
            number: [
                {
                    name: "min tag percentage",
                    defaultValue: 0,
                    maxValue: Infinity,
                    minValue: 0,
                },
                {
                    name: "scoring system",
                    maxValue: Infinity,
                    minValue: 0,
                },
                {
                    name: "sample size",
                    maxValue: Infinity,
                    minValue: 1,
                },
                {
                    name: "min sample size",
                    maxValue: Infinity,
                    minValue: 1,
                },
                {
                    name: "min average score",
                    minValue: 1,
                },
                {
                    name: "min anime popularity",
                    maxValue: Infinity,
                    minValue: 1,
                },
                {
                    name: "min manga popularity",
                    maxValue: Infinity,
                    minValue: 1,
                },
                {
                    name: "min novel popularity",
                    maxValue: Infinity,
                    minValue: 1,
                }
            ]
        }
    }
    const filterConfig = {
        readOnly: {
            "flexible inclusion": 1,
            "shown metric": 1
        },
        staticSelection: {
            season: 1,
            "flexible inclusion": 1,
            "shown metric": 1,
            "shown list": 1
        },
        selection: {
            "Media Filter": [
                "genre",
                "tag",
                "season",
                "release status",
                "user status",
                "format",
                "country of origin",
                "shown metric",
                "shown list",
                "flexible inclusion",
                "year",
                "studio",
            ],
            "Content Caution": [
                "genre",
                "tag",
            ],
            "Algorithm Filter": [
                "genre",
                "tag",
                "tag category",
            ]
        }
    }

    let algorithmFilters = await retrieveJSON("algorithmFilters")
    if (!(algorithmFilters instanceof Array)) {
        algorithmFilters = [
            {
                filterType: "bool",
                optionName: "content focused",
                status: "none"
            },
            {
                filterType: "bool",
                optionName: "inc. all factors",
                status: "none"
            },
            {
                filterType: "bool",
                optionName: "inc. average score",
                status: "none"
            },
            {
                filterType: "bool",
                optionName: "exclude year",
                status: "none"
            },
        ]
        collectionToPut.algorithmFilters = algorithmFilters
    }

    if (!jsonIsEmpty(collectionToPut)) {
        await saveJSONCollection(collectionToPut)
    }

    self.postMessage({ status: null })
    self.postMessage({
        tagInfo,
        orderedFilters,
        nonOrderedFilters,
        filterConfig,
        algorithmFilters
    })
    
};
function IDBinit() {
    return new Promise((resolve) => {
        let request = indexedDB.open(
            "Kanshi.Media.Recommendations.Anilist.W~uPtWCq=vG$TR:Zl^#t<vdS]I~N70",
            1
        );
        request.onsuccess = (event) => {
            db = event.target.result;
            resolve()
        };
        request.onupgradeneeded = (event) => {
            db = event.target.result;
            db.createObjectStore("others");
            event.target.transaction.oncomplete = () => {
                resolve();
            }
        }
        request.onerror = (error) => {
            console.error(error);
        };
    })
}
function retrieveJSON(name) {
    return new Promise((resolve) => {
        try {
            let get = db
                .transaction("others", "readonly")
                .objectStore("others")
                .get(name);
            get.onsuccess = () => {
                let result = get.result;
                if (result instanceof Blob) {
                    result = JSON.parse((new FileReaderSync()).readAsText(result));
                } else if (result instanceof ArrayBuffer) {
                    result = JSON.parse((new TextDecoder()).decode(result));
                }
                resolve(result);
            };
            get.onerror = (ex) => {
                console.error(ex);
                resolve();
            };
        } catch (ex) {
            console.error(ex);
            resolve();
        }
    });
}
function saveJSONCollection(collection) {
    return new Promise((resolve, reject) => {
        try {
            let transaction = db.transaction("others", "readwrite");
            let store = transaction.objectStore("others");
            let put;
            transaction.oncomplete = () => {
                resolve();
            }
            for (let key in collection) {
                let data = collection[key];
                let blob
                if (data instanceof Blob) {
                    blob = data
                    put = store.put(blob, key);
                } else if (isJsonObject(data) || data instanceof Array) {
                    blob = new Blob([JSON.stringify(data)]);
                    put = store.put(blob, key);
                } else {
                    put = store.put(data, key);
                }
                put.onerror = (ex) => {
                    transaction.oncomplete = undefined;
                    if (blob instanceof Blob) {
                        try {
                            transaction.oncomplete = () => {
                                resolve();
                            }
                            put = store.put((new FileReaderSync()).readAsArrayBuffer(blob), key);
                            put.onerror = (ex) => {
                                console.error(ex);
                                reject(ex);
                            }
                            try {
                                transaction?.commit?.();
                            } catch {}
                        } catch (ex2) {
                            console.error(ex);
                            console.error(ex2);
                            reject(ex2);
                        }
                    } else {
                        console.error(ex);
                        reject(ex);
                    }
                };
            }
            try {
                transaction?.commit?.();
            } catch {}
        } catch (ex) {
            console.error(ex);
            reject(ex);
        }
    });
}
function jsonIsEmpty(obj) {
    for (const key in obj) {
        return false;
    }
    return true;
}
function isJsonObject(obj) {
    return Object.prototype.toString.call(obj) === "[object Object]"
}